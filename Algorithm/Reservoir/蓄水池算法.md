### 蓄水池算法

#### 蓄水池算法的应用
做一个游戏的抽奖系统，游戏服务器在全球范围内都有，所有人只有第一次登录游戏服务器的才会有抽奖的资格
游戏的抽奖时间20xx年1月1日00时00分到开奖时间20xx年1月2日00时00分
中奖人数共100人，该范围内的所有人都等概率中奖

1.如果不使用蓄水池算法，需要将登录服务器的所有用户名单拿到手，抽100个人
获取登录用户名单非常繁琐，并且需要20xx年1月1日23时00分都可能还在收集登录用户名单
并且到了开奖时间20xx年1月2日00时00分还无法直接公布中奖名单

2.如果使用蓄水池算法，只需要全球所有服务器只跟一台服务器沟通，上线一些数据即可
1)用户登录是否是第一次，如果不是第一次，之后登录的次数没有抽奖资格
2)如果知道用户在全球中是第i个登录的，该用户进入奖池的概率是100 / i，如果100 / i的概率没有进入奖池，那么再也进入不了奖池
但如果100 / i的概率进入奖池，那么就在100个的奖池中随机剔除掉一个
3)在开奖时间20xx年1月2日00时00分直接公布中奖名单，绝对全球所有登录的用户等概率获奖，而且代码的部署量少得多


#### 额外面试题
设计生成UUID(唯一的一个专属编号)的系统，服务全球通用，你负责申请不同的编号即可，生成的UUID都不一样，
吞吐量超大，并且生成的UUID编号每一个都不一样，如何设计该系统，要求在吞吐量巨大的情况下，重复的概率为0，不需要管编号干什么

思路分析：
1.利用垂直扩展的技巧解决
2.哈希算法不能保证UUID重复的概率为0
3.准备一台机器，该机器有多台从机，并且只需要维持两个变量的数据
1)当前机器生成到多少号了
2)range也就是范围

4.不同国家的服务器只需要维持两个变量：range和UUID的最小值
如果想要减少不同国家的服务器对主服务器的访问频率，增加range即可



